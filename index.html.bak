<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Magic Hands: Crystal Pop V9</title>
    
    <!-- 1. 样式 -->
    <link rel="stylesheet" href="./style.css">

    <!-- 2. 核心库 (CDN 必须按顺序) -->
    <script src="https://cdn.jsdelivr.net/npm/@mediapipe/hands/hands.js" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/@mediapipe/camera_utils/camera_utils.js" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>

    <style>
        /* 调试面板：如果报错，屏幕顶部会显示红字 */
        #debug-log {
            position: fixed; top: 0; left: 0; width: 100%; 
            background: rgba(255,0,0,0.8); color: white; 
            z-index: 9999; display: none; padding: 5px; font-size: 12px;
        }
    </style>
</head>
<body>
    <div id="debug-log"></div>

    <div id="game-app">
        <!-- 动态背景 -->
        <div class="gradient-bg"></div>

        <!-- 启动大厅 -->
        <div id="start-screen">
            <div class="logo-area">✨ Crystal Pop</div>
            <p>抓住那些漂浮的水晶泡泡！</p>
            <p style="font-size:12px; color:#ddd; margin-top:5px;">(请确保设备音量已打开)</p>
            <button id="btn-start">开始游戏 (Start)</button>
        </div>

        <!-- 游戏 HUD -->
        <div id="hud">
            <div class="score-pill">🌟 <span id="score">0</span></div>
            
            <!-- 学习卡片 (弹窗) -->
            <div id="learning-card">
                <div class="card-glass">
                    <div id="card-icon">🍎</div>
                    <div class="text-group">
                        <h2 id="card-en">APPLE</h2>
                        <h3 id="card-cn">苹果</h3> <!-- 这里会动态填入 -->
                        <div id="card-pron">/ˈæp.əl/</div>
                    </div>
                </div>
            </div>
        </div>

        <video id="webcam" playsinline style="display:none"></video>
        <canvas id="game-canvas"></canvas>
    </div>

    <!-- 3. 主逻辑 -->
    <script type="module" src="./main.js"></script>

    <!-- 4. 全局错误捕捉 -->
    <script>
        window.onerror = function(msg, url, line) {
            const d = document.getElementById('debug-log');
            d.style.display = 'block';
            d.innerHTML += `❌ ${msg} (Line ${line})<br>`;
        }
    </script>
</body>
</html>